{
  "id" : "io.github.wine-x86_64",
  "default-branch" : "stable",
  "runtime" : "org.freedesktop.Platform",
  "runtime-version" : "20.08",
  "runtime-commit" : "3df94b90f4198d3a6bd56400600818b41e23006b8a0bbbeec9634238851033af",
  "sdk" : "org.freedesktop.Sdk",
  "sdk-commit" : "32b0b21c6fecd836a1fe32342e22579bdbe38db90bf3430c85e3037eec13bc4a",
  "base-version" : "20.08",
  "command" : "wine",
  "modules" : [
    {
      "name" : "compat",
      "buildsystem" : "simple",
      "build-commands" : [
        "mkdir -p /app/lib/i386-linux-gnu /app/lib/debug/lib/i386-linux-gnu"
      ]
    },
    {
      "name" : "openldap",
      "config-opts" : [
        "--disable-slapd",
        "--disable-slurpd",
        "--disable-bdb",
        "--disable-hdb"
      ],
      "sources" : [
        {
          "url" : "https://www.openldap.org/software/download/OpenLDAP/openldap-release/openldap-2.4.55.tgz",
          "sha256" : "97357bd6ba8ff73d204c1f8208c5e6ab97d60c9e779f989057aa1229bbe98434",
          "type" : "archive"
        }
      ],
      "build-options" : {
        "ldflags" : "-L/app/lib32",
        "libdir" : "/app/lib32",
        "env" : {
          "CC" : "i686-unknown-linux-gnu-gcc",
          "CXX" : "i686-unknown-linux-gnu-g++"
        },
        "strip" : true,
        "no-debuginfo" : true,
        "prepend-path" : "/usr/lib/sdk/toolchain-i386/bin",
        "prepend-pkg-config-path" : "/app/lib32/pkgconfig:/usr/lib/i386-linux-gnu/pkgconfig"
      },
      "cleanup" : [
        "/bin"
      ]
    },
    {
      "name" : "openldap64",
      "config-opts" : [
        "--disable-slapd",
        "--disable-slurpd",
        "--disable-bdb",
        "--disable-hdb"
      ],
      "sources" : [
        {
          "url" : "https://www.openldap.org/software/download/OpenLDAP/openldap-release/openldap-2.4.55.tgz",
          "sha256" : "97357bd6ba8ff73d204c1f8208c5e6ab97d60c9e779f989057aa1229bbe98434",
          "type" : "archive"
        }
      ],
      "build-options" : {
        "strip" : true,
        "no-debuginfo" : true
      },
      "cleanup" : [
        "/bin"
      ]
    },
    {
      "name" : "faudio32",
      "buildsystem" : "cmake-ninja",
      "config-opts" : [
        "-DGSTREAMER=ON"
      ],
      "sources" : [
        {
          "url" : "https://github.com/FNA-XNA/FAudio/archive/20.12.tar.gz",
          "sha256" : "d5a1656ec79cd2878dddabc07d7f7848c11844595c76033aed929b10d922c009",
          "type" : "archive"
        }
      ],
      "build-options" : {
        "ldflags" : "-L/app/lib32",
        "libdir" : "/app/lib32",
        "env" : {
          "CC" : "i686-unknown-linux-gnu-gcc",
          "CXX" : "i686-unknown-linux-gnu-g++"
        },
        "strip" : true,
        "no-debuginfo" : true,
        "prepend-path" : "/usr/lib/sdk/toolchain-i386/bin",
        "prepend-pkg-config-path" : "/app/lib32/pkgconfig:/usr/lib/i386-linux-gnu/pkgconfig"
      }
    },
    {
      "name" : "faudio64",
      "buildsystem" : "cmake-ninja",
      "config-opts" : [
        "-DGSTREAMER=ON"
      ],
      "sources" : [
        {
          "url" : "https://github.com/FNA-XNA/FAudio/archive/20.12.tar.gz",
          "sha256" : "d5a1656ec79cd2878dddabc07d7f7848c11844595c76033aed929b10d922c009",
          "type" : "archive"
        }
      ],
      "build-options" : {
        "strip" : true,
        "no-debuginfo" : true
      }
    },
    {
      "name" : "wine-x86_64",
      "buildsystem" : "simple",
      "builddir" : true,
      "make-install-args" : [
        "LDCONFIG=/bin/true",
        "STRIP=/bin/true",
        "UPDATE_DESKTOP_DATABASE=/bin/true"
      ],
      "sources" : [
        {
          "url" : "https://dl.winehq.org/wine/source/6.0/wine-6.0.tar.xz",
          "sha512" : "c0732fbab1da8737d595a876b28ce87eef1440c317746e798642b59b44b34e890de562e0c0cc674e97096f39db82f8e9c3b1cc1ba9edc246b7266a0f7cb00057",
          "type" : "archive"
        }
      ],
      "build-options" : {
        "ldflags" : "-L/app/lib64 -L/app/lib32",
        "prefix" : "/app",
        "libdir" : "/app/lib32",
        "env" : {
          "CC" : "i686-unknown-linux-gnu-gcc",
          "CXX" : "i686-unknown-linux-gnu-g++"
        },
        "strip" : true,
        "no-debuginfo" : true,
        "append-path" : "/usr/lib/sdk/toolchain-i386/bin",
        "prepend-path" : "/app/bin"
      },
      "build-commands" : [
        "export CC=x86_64-unknown-linux-gnu-gcc  && export CXX=x86_64-unknown-linux-gnu-g++ && mkdir wine64-build && cd wine64-build   && ../configure --prefix=\"/app\" --disable-win16 --disable-tests --with-x --without-cups --without-curses --without-capi --without-glu --without-gphoto --without-gsm --without-hal --with-ldap --with-faudio --without-netapi --without-mono --without-test --enable-win64 && make -j2",
        "export CC=i686-unknown-linux-gnu-gcc  && export CXX=i686-unknown-linux-gnu-g++ && mkdir wine32-tools && cd wine32-tools && ../configure --prefix=\"/app\" --disable-win16 --disable-tests --with-x --without-cups --without-curses --without-capi --without-glu --without-gphoto --without-gsm --without-hal --with-ldap --with-faudio --without-netapi --without-mono --without-test && make -j2",
        "export CC=i686-unknown-linux-gnu-gcc  && export CXX=i686-unknown-linux-gnu-g++ && mkdir wine32-combo && cd wine32-combo && ../configure --with-wine64=../wine64-build --with-wine-tools=../wine32-tools --prefix=\"/app\" --disable-win16 --disable-tests --with-x --without-cups --without-curses --without-capi --without-glu --without-gphoto --without-gsm --without-hal --with-ldap --with-faudio --without-netapi --without-mono --without-test     && make -j2           && make install       && cd ../wine64-build && make install"
      ]
    },
    {
      "name" : "winetricks",
      "buildsystem" : "simple",
      "sources" : [
        {
          "url" : "https://github.com/Winetricks/winetricks/releases/download/20210206/20210206.tar.gz",
          "sha256" : "705421798b28696f577104ebdf03b068b9343ab096754150f47a6ec06fa8ae65",
          "type" : "archive"
        }
      ],
      "build-commands" : [
        "make",
        "make PREFIX=/app install",
        "chmod +x /app/bin/winetricks"
      ]
    },
    {
      "name" : "cabextract",
      "buildsystem" : "autotools",
      "sources" : [
        {
          "url" : "https://www.cabextract.org.uk/cabextract-1.6.tar.gz",
          "sha256" : "cee661b56555350d26943c5e127fc75dd290b7f75689d5ebc1f04957c4af55fb",
          "type" : "archive"
        }
      ]
    },
    {
      "name" : "wget",
      "buildsystem" : "autotools",
      "sources" : [
        {
          "url" : "https://ftp.gnu.org/gnu/wget/wget-1.19.4.tar.gz",
          "sha256" : "93fb96b0f48a20ff5be0d9d9d3c4a986b469cb853131f9d5fe4cc9cecbc8b5b5",
          "type" : "archive"
        }
      ]
    },
    {
      "name" : "winedesktop",
      "buildsystem" : "simple",
      "build-commands" : [
        "install -Dm644 /app/share/icons/hicolor/scalable/apps/winetricks.svg /app/share/icons/hicolor/scalable/apps/io.github.wine-x86_64.svg",
        "desktop-file-edit --set-name=\"wine-x86_64(flatpak)\" /app/share/applications/wine.desktop",
        "desktop-file-edit --set-icon=io.github.wine-x86_64 /app/share/applications/wine.desktop",
        "desktop-file-edit --set-key=\"Exec\" --set-value=\"run.sh %F\" /app/share/applications/wine.desktop",
        "desktop-file-edit --set-key=\"MimeType\" --set-value=\"application/x-ms-dos-executable;\" /app/share/applications/wine.desktop",
        "desktop-file-edit --set-key=\"NoDisplay\" --set-value=\"false\" /app/share/applications/wine.desktop",
        "desktop-file-edit --set-name=\"winetricks-x86_64(flatpak)\" /app/share/applications/winetricks.desktop",
        "desktop-file-edit --set-icon=io.github.wine-x86_64-winetricks /app/share/applications/winetricks.desktop",
        "desktop-file-edit --set-key=\"Exec\" --set-value=\"run.sh winetricks\" /app/share/applications/winetricks.desktop",
        "install -Dm644    /app/share/applications/winetricks.desktop /app/share/applications/io.github.wine-x86_64-winetricks.desktop",
        "install -Dm644 /app/share/icons/hicolor/scalable/apps/winetricks.svg /app/share/icons/hicolor/scalable/apps/io.github.wine-x86_64-winetricks.svg"
      ]
    },
    {
      "name" : "run.sh",
      "buildsystem" : "simple",
      "sources" : [
        {
          "path" : "run.sh",
          "type" : "file"
        }
      ],
      "build-commands" : [
        "install -Dm755 run.sh /app/bin/run.sh"
      ]
    }
  ],
  "cleanup" : [
    "/lib/debug",
    "/bin/extresso",
    "/bin/genresscript",
    "/bin/icotool",
    "/bin/wrestool",
    "/share/man",
    "/include",
    "/share/applications/winetricks.desktop",
    "/app/share/icons/hicolor/scalable/apps/winetricks.svg",
    "/app/share/applications/winetricks.desktop"
  ],
  "separate-locales" : false,
  "sdk-extensions" : [
    "org.freedesktop.Sdk.Compat.i386",
    "org.freedesktop.Sdk.Extension.toolchain-i386"
  ],
  "finish-args" : [
    "--share=ipc",
    "--socket=x11",
    "--share=network",
    "--socket=pulseaudio",
    "--allow=multiarch",
    "--allow=devel",
    "--talk-name=org.freedesktop.Notifications",
    "--filesystem=host",
    "--filesystem=~/.wine-x86_64:create",
    "--device=all",
    "--persist=~/.wine-x86_64",
    "--env=WINEDLLOVERRIDES=mscoree,mshtml=",
    "--env=LD_LIBRARY_PATH=/app/lib:/app/lib32",
    "--env=WINE_RESOLUTION=1920x1080"
  ],
  "rename-desktop-file" : "wine.desktop",
  "add-extensions" : {
    "org.freedesktop.Platform.Compat.i386" : {
      "directory" : "lib/i386-linux-gnu",
      "version" : "20.08"
    },
    "org.freedesktop.Platform.GL32" : {
      "directory" : "lib/i386-linux-gnu/GL",
      "add-ld-path" : "lib",
      "download-if" : "active-gl-driver",
      "enable-if" : "active-gl-driver",
      "merge-dirs" : "vulkan/icd.d;glvnd/egl_vendor.d;OpenCL/vendors;lib/dri;lib/d3d;vulkan/explicit_layer.d",
      "version" : "1.4",
      "versions" : "20.08;1.4"
    },
    "org.freedesktop.Platform.VAAPI.Intel" : {
      "directory" : "lib/dri/intel-vaapi-driver",
      "download-if" : "have-intel-gpu"
    },
    "org.gnome.Platform.Compat.i386.Debug" : {
      "directory" : "lib/debug/lib/i386-linux-gnu",
      "version" : "20.08"
    }
  }
}